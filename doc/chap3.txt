  
  [1X3 [33X[0;0YCommutative Involutive Bases[133X[101X
  
  [33X[0;0YGiven  a GrÃ¶bner Basis [22XG[122X for an ideal [22XJ[122X over a polynomial ring [22XmathcalR[122X, the
  remainder  of  any polynomial [22Xp âˆˆ mathcalR[122X with respect to [22XG[122X is unique. But,
  although  this remainder is unique, there may be many ways of obtaining this
  remainder,  as it is possible that several polynomials in [22XG[122X divide [22Xp[122X, giving
  several [13Xreduction paths[113X for [22Xp[122X.[133X
  
  
  [1X3.1 [33X[0;0YReduction Paths[133X[101X
  
  
  [1X3.1-1 [33X[0;0YAn Example[133X[101X
  
  [33X[0;0YConsider  the  DegLex  GrÃ¶bner  basis  [22XG  := {g_1, g_2, g_3} = {a^2-2ab+3, :
  2ab+b^2+5,  :  frac54b^3-frac52a+frac374b}[122X  over the polynomial ring [22XQ[a,b][122X,
  and  consider  the  polynomial  [22Xp  :=  a^2b+b^3+8b[122X.  The remainder of [22Xp[122X with
  respect to [22XG[122X is [22X0[122X (so that [22Xp[122X is a member of the ideal [22XJ[122X generated by [22XG[122X), but
  there  are  two  ways of obtaining this remainder, as shown in the following
  diagram.[133X
  
  
  [24X[33X[0;6Y\vcenter{\xymatrix{    &    a^2b+b^3+8b   \ar[dl]_{g_1}   \ar[dr]^{g_2}   \\
  2ab^2+b^3+5b  \ar[d]_{g_2}  &&  -\frac{1}{2}ab^2  +  b^3  -  \frac{5}{2}a+8b
  \ar[d]^{g_2}  \\ 0 && \frac{5}{4}b^3-\frac{5}{2}a+\frac{37}{4}b \ar[d]^{g_3}
  \\ && 0 }}[133X
  
  [124X
  
  [33X[0;0YAn  [13XInvolutive  Basis[113X for [22XJ[122X is a GrÃ¶bner Basis [22XG[122X such that there is only [13Xone[113X
  possible  reduction  path  for any polynomial [22Xp âˆˆ mathcalR[122X. In order to find
  such  a  basis,  we restrict which reductions or divisions may take place by
  requiring,  for  each  potential reduction of a polynomial [22Xp[122X by a polynomial
  [22Xg_i  âˆˆ  G[122X  (so  that  [22XLM(p)  =  LM(g_i)Ã—  u[122X for some monomial [22Xu[122X), some extra
  conditions  on the variables in [22Xu[122X to be satisfied, namely that all variables
  in  [22Xu[122X have to be in a set of [13Xmultiplicative variables[113X for [22Xg_i[122X, a set that is
  determined by a particular choice of an [13Xinvolutive division[113X.[133X
  
  
  [1X3.2 [33X[0;0YCommutative Involutive Divisions[133X[101X
  
  [33X[0;0YRecall  that  a commutative monomial [22Xu[122X is divisible by another monomial [22Xw[122X if
  there  exists a third monomial [22Xu'[122X such that [22Xu = wu'[122X. We use the notation [22Xw âˆ£
  u[122X  and  refer  to [22Xw[122X as a [13Xconventional[113X divisor of [22Xu[122X. An involutive division [22XI[122X
  partitions  the variables in the polynomial ring into sets of [13Xmultiplicative[113X
  and  [13Xnonmultiplicative[113X  variables for [22Xu[122X. The set of multiplicative variables
  is denoted by [22XmathcalM_I(u)[122X. Then [22Xw[122X is an [13Xinvolutive divisor[113X of [22Xu[122X, written [22Xw
  âˆ£_I u[122X, if all variables in [22Xu'[122X are in [22XmathcalM_I(u)[122X.[133X
  
  
  [1X3.2-1 [33X[0;0YExample[133X[101X
  
  [33X[0;0YLet  [22Xu  :=  ab^3c[122X,  [22Xv  :=  abc^3[122X  and  [22Xw  :=  bc[122X be three monomials over the
  polynomial ring [22XmathcalR := Q[a,b,c][122X. Let an involutive division [22XI[122X partition
  the  variables  in [22XmathcalR[122X into the following two sets of variables for the
  monomial [22Xw[122X: multiplicative = [22X{a,b}[122X; nonmultiplicative = [22X{c}[122X. It is true that
  [22Xw[122X  conventionally  divides  both  monomials [22Xu[122X and [22Xv[122X, but [22Xw[122X only involutively
  divides  monomial  [22Xu[122X as, defining [22Xu' := ab^2[122X and [22Xv' := ac^2[122X (so that [22Xu = wu'[122X
  and  [22Xv  =  wv'[122X),  we  observe  that  all  variables  in [22Xu'[122X are in the set of
  multiplicative  variables  for [22Xw[122X, but the variables in [22Xv'[122X (in particular the
  variable  [22Xc[122X)  are not all in the set of multiplicative variables for [22Xw[122X. So [22Xw
  âˆ£_I u[122X and [22Xw âˆ¤_I v[122X.[133X
  
  [1X3.2-2 PommaretDivision[101X
  
  [33X[1;0Y[29X[2XPommaretDivision[102X( [3Xalg[103X, [3Xmons[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YLet  [22XmathcalR  =  Q[a_1,...,a_n][122X, and let [22Xw[122X be a polynomial in [22XmathcalR[122X with
  leading monomoial [22Xa_1^e_1a_2^e_2 ... a_n^e_n[122X where [22Xe_i[122X is the [13Xfirst[113X non-zero
  exponent.     The     Pommaret    involutive    division    [22XmathcalP[122X    sets
  [22XmathcalM_mathcalP}(w) = {a_1, a_2, ..., a_i}[122X.[133X
  
  [33X[0;0YBecause  [22XmathcalM_mathcalP}(w)[122X  does  not  depend  in  any  way on the other
  leading monomials in [13Xpolys[113X, this is a [13Xglobal[113X division.[133X
  
  [33X[0;0YIn  The  example  the first five monomials [22Xu_i[122X in [22XU[122X contain a power of [22Xx[122X, so
  [22XmathcalM_mathcalP}(u_i)   =   {x}[122X.   Then   [22Xu_6[122X   involves   [22Xy[122X   and  [22Xz[122X,  so
  [22XmathcalM_mathcalP}(u_6)  =  {x,y}[122X,  and  similarly [22XmathcalM_mathcalP}(u_7) =
  {x,y,z}[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XR := PolynomialRing( Rationals, [ "x", "y", "z" ] );;[127X[104X
    [4X[25Xgap>[125X [27Xx := R.1;; y := R.2;; z := R.3;;[127X[104X
    [4X[25Xgap>[125X [27XU := [ x^5*y^2*z, x^4*y*z^2, x^2*y^2*z, x*y*z^3, x*z^3, y^2*z, z ];[127X[104X
    [4X[28X[ x^5*y^2*z, x^4*y*z^2, x^2*y^2*z, x*y*z^3, x*z^3, y^2*z, z ][128X[104X
    [4X[25Xgap>[125X [27Xord := MonomialLexOrdering();;[127X[104X
    [4X[25Xgap>[125X [27XPommaretDivision( R, U, ord );[127X[104X
    [4X[28X[ [ 1 ], [ 1 ], [ 1 ], [ 1 ], [ 1 ], [ 1, 2 ], [ 1 .. 3 ] ][128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [1X3.2-3 ThomasDivision[101X
  
  [33X[1;0Y[29X[2XThomasDivision[102X( [3Xalg[103X, [3Xmons[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YLet  [22XmathcalR  =  Q[a_1,...,a_n][122X,  and  let  [22XP[122X  be  a set of polynomials [22XP =
  {p_1,...,p_m}[122X in [22XmathcalR[122X with leading monomials [22XU = {u_1,...,u_m}[122X where [22Xu_i
  =  a_1^e^1_ia_2^e^2_i ... a_n^e^n_i[122X. The Thomas involutive division [22XmathcalT[122X
  sets [22Xa_i[122X to be multiplicative for [22Xp_j[122X and [22Xu_j[122X if [22Xe^i_j = max_k e^i_k[122X for all
  [22X1 leqslant k leqslant m[122X.[133X
  
  [33X[0;0YIn  the  example,  using  the  same  seven  monomials, the highest powers of
  [22X[x,y,z][122X  are [22X[5,2,3][122X respectively. So [22Xx[122X is multiplicative only for [22Xu_1[122X, [22Xy[122X is
  multiplicative  for  [22X{u_1,u_3,u_6}[122X, and [22Xz[122X is multiplicative only for [22Xu_4[122X and
  [22Xu_5[122X. Note that two of the monomials have no multiplicative variable.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XThomasDivision( R, U, ord );[127X[104X
    [4X[28X[ [ 1, 2 ], [  ], [ 2 ], [ 3 ], [ 3 ], [ 2 ], [  ] ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [1X3.2-4 JanetDivision[101X
  
  [33X[1;0Y[29X[2XJanetDivision[102X( [3Xalg[103X, [3Xmons[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YLet  [22XmathcalR  =  Q[a_1,...,a_n][122X,  and  let  [22XP[122X  be  a set of polynomials [22XP =
  {p_1,...,p_m}[122X in [22XmathcalR[122X with leading monomials [22XU = {u_1,...,u_m}[122X where [22Xu_i
  =  a_1^e^1_ia_2^e^2_i  ... a_n^e^n_i[122X. The Janet involutive division [22XmathcalJ[122X
  sets [22Xa_n[122X to be multiplicative for [22Xu_j[122X provided [22Xe^n_j = max_k e^n_k[122X for all [22X1
  leqslant  k  leqslant m[122X. To determine whether [22Xa_i[122X is multiplicative for [22Xu_j[122X,
  let  [22XL  =  [e^i+1_j,e^i+2_j,...,e^n_j][122X.  Let  [22XS[122X  be  the subset of [22X{1,...,m}[122X
  containing  those  [22Xk[122X  such that [22X[e^i+1_k,e^i+2_k,...,e^n_k] = L[122X. Then [22Xa_i[122X is
  multiplicative for [22Xu_j[122X provided [22Xe^i_j = max_k âˆˆ Se^i_k[122X.[133X
  
  [33X[0;0YIn the example, recall that the exponent lists for the seven monomials are[133X
  
  
  [24X[33X[0;6Y[5,2,1],~~~  [4,1,2],~~~  [2,2,1],~~~  [1,1,3],~~~  [1,0,3],~~~  [0,2,1],~~~
  [0,0,1].[133X
  
  [124X
  
  [33X[0;0YAs  with  the  Thomas division, [22Xmax_k e^3_k = 3[122X and [22Xz[122X is multiplicative only
  for [22Xu_4[122X and [22Xu_5[122X.[133X
  
  [33X[0;0YFor  [22Xy[122X,  [22XL  =  [1][122X  when  [22Xk âˆˆ {1,3,6,7}[122X and [22Xmax_{1,3,6,7} e^2_k = 2[122X, so [22Xy[122X is
  multiplicative  for [22Xu_1, u_3[122X and [22Xu_6[122X, but not for [22Xu_7[122X. [22XL = [2][122X only for [22Xu_2[122X,
  so  [22Xy[122X is multiplicative for [22Xu_2[122X. [22XL = [3][122X for [22Xu_4[122X and [22Xu_5[122X, and [22Xe^2_4 > e^2_5[122X,
  so [22Xy[122X is multiplicative for [22Xu_4[122X but not [22Xu_5[122X.[133X
  
  [33X[0;0YFor  [22Xx[122X,  [22XL  =  [2,1][122X for [22Xk âˆˆ {1,3,6}[122X and [22Xe^1_1 = 5[122X is greater than [22Xe^1_3[122X and
  [22Xe^1_6[122X, so [22Xx[122X is multiplicative for [22Xu_1[122X. The other values for [22XL[122X, namely [22X[1,2],
  [1,3],  [0,3][122X  and  [22X[0,1][122X,  occur just once each, so [22Xx[122X is multiplicative for
  [22Xu_2, u_4, u_5[122X and [22Xu_7[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XJanetDivision( R, U, ord );[127X[104X
    [4X[28X[ [ 1, 2 ], [ 1, 2 ], [ 2 ], [ 1, 2, 3 ], [ 1, 3 ], [ 2 ], [ 1 ] ][128X[104X
    [4X[28X[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  
  [1X3.2-5 [33X[0;0YSelecting a Division[133X[101X
  
  [33X[0;0YThe  global  variable  [10XCommutativeDivision[110X is a string which can take values
  "Pommaret",  "Thomas"  or  "Janet".  The  default is "Pommaret". The example
  shows how to select the Janet division.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XCommutativeDivision := "Janet";[127X[104X
    [4X[28X"Janet"[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [1X3.2-6 DivisionRecord[101X
  
  [33X[1;0Y[29X[2XDivisionRecord[102X( [3Xalg[103X, [3Xpolys[103X, [3Xorder[103X ) [32X function[133X
  [33X[1;0Y[29X[2XDivisionRecordCP[102X( [3Xalg[103X, [3Xpolys[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YThe   global   function   [10XDivisionRecord[110X   calls   one   of  the  operations
  [10XDivisionRecordCP[110X  and  [10XDivisionRecordNP[110X, depending on whether the algebra is
  commutative or not. In the commutative case, this function finds the sets of
  multiplicative  variables  for  a  set  of  polynomials  using  one  of  the
  involutive divisions listed above.[133X
  
  [33X[0;0YIn  the  following example, polynomials [22X{u = b^3-a, v=a^3-b}[122X define an ideal
  and  form a GrÃ¶bner basis for that ideal. Multiplicative variables for [22Xu[122X are
  [22X{a,b}[122X,  while  those  for  [22Xv[122X  are  just [22X{a}[122X. The variable [10Xdrec2.mvars[110X in the
  listing  below  contains  the [13Xpositions[113X of these variables in the generating
  set [22X{a,b}[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XR := PolynomialRing( Rationals, [ "a", "b" ] );;[127X[104X
    [4X[25Xgap>[125X [27Xa := R.1;; b := R.2;;[127X[104X
    [4X[25Xgap>[125X [27XL2 := [ b^3 - 3*a, a^3 - 3*b ];;[127X[104X
    [4X[25Xgap>[125X [27Xord := MonomialGrlexOrdering();;[127X[104X
    [4X[25Xgap>[125X [27XGB2 := ReducedGroebnerBasis( L2, ord );;[127X[104X
    [4X[25Xgap>[125X [27XGB2 = L2;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XCommutativeDivision := "Pommaret";;[127X[104X
    [4X[25Xgap>[125X [27Xdrec2 := DivisionRecordCP( R, L2, ord );[127X[104X
    [4X[28Xrec( div := "Pommaret", mvars := [ [ 1, 2 ], [ 1 ] ], [128X[104X
    [4X[28X  polys := [ b^3-3*a, a^3-3*b ] )[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  
  [24X[33X[0;6Y\vcenter{\xymatrix@=1em{  b  &  &  &  \ar@{-}[ddddrrrr]  & \ar@{-}[dddrrr] &
  \ar@{-}[ddrr]  & \ar@{-}[dr] & & & & b & & & & & & & \\ : \ar[u] \ar@{-}[ur]
  &  \cdot & \cdot & \cdot \ar@{-}[ddddrrrr] & \cdot & \cdot & \cdot & & & & :
  \ar[u]  \ar@{-}[ur]  &  \cdot & \cdot & \cdot & \cdot & \cdot & \cdot & \\ 5
  \ar@{-}[u] \ar@{-}[uurr] & \cdot & \cdot & \cdot \ar@{-}[ddddrrrr] & \cdot &
  \cdot  &  \cdot & & & & 5 \ar@{-}[u] \ar@{-}[uurr] & \cdot & \cdot & \cdot &
  \cdot  &  \cdot  & \cdot & \\ 4 \ar@{-}[u] \ar@{-}[uuurrr] & \cdot & \cdot &
  \cdot  \ar@{-}[ddddrrrr]  &  \cdot  &  \cdot  &  \cdot  & & & & 4 \ar@{-}[u]
  \ar@{-}[uuurrr] & \cdot & \cdot & \cdot & \cdot & \cdot & \cdot & \\ \bullet
  \ar@{-}[u]  \ar@{-}[rrrrrrr]  \ar@{-}[uuuurrrr]  & \cdot \ar@{-}[uuuurrrr] &
  \cdot  \ar@{-}[uuuurrrr]  &  \cdot \ar@{-}[dddrrr] \ar@{-}[uuuurrrr] & \cdot
  \ar@{-}[uuurrr]  &  \cdot  \ar@{-}[uurr] & \cdot \ar@{-}[ur] & & & & \bullet
  \ar@{-}[u]  \ar@{-}[rrrrrrr]  \ar@{-}[uuuurrrr]  & \cdot \ar@{-}[uuuurrrr] &
  \cdot  \ar@{-}[uuuurrrr] & \cdot \ar@{-}[uuuurrrr] & \cdot \ar@{-}[uuurrr] &
  \cdot  \ar@{-}[uurr] & \cdot \ar@{-}[ur] & & \\ 2 \ar@{-}[u] & \cdot & \cdot
  & \cdot \ar@{-}[ddrr] & \cdot & \cdot & \cdot & & & & 2 \ar@{-}[u] & \cdot &
  \cdot  &  \bullet  \ar@{-}[rrrr]&  \cdot & \cdot & \cdot & \\ 1 \ar@{-}[u] &
  \cdot  &  \cdot  &  \cdot  \ar@{-}[dr]  &  \cdot  &  \cdot & \cdot & & & & 1
  \ar@{-}[u] & \cdot & \cdot & \bullet \ar@{-}[rrrr] & \cdot & \cdot & \cdot &
  \\ 0 \ar@{-}[r]\ar@{-}[u] & 1 \ar@{-}[r] & 2 \ar@{-}[r] & \bullet \ar@{-}[r]
  \ar@{-}[uuuuuuu]  &  4 \ar@{-}[r] & 5 \ar@{-}[r] & \cdots \ar[r] & a & & & 0
  \ar@{-}[r]\ar@{-}[u]  &  1  \ar@{-}[r]  &  2 \ar@{-}[r] & \bullet \ar@{-}[r]
  \ar@{-}[uuuuuuu] & 4 \ar@{-}[r] & 5 \ar@{-}[r] & \cdots \ar[r] & a }}[133X
  
  [124X
  
  [33X[0;0YIn  the  [13Xreduction  diagrams[113X  above  the nodes [22X(j,k)[122X represent the monomials
  [22Xa^jb^k[122X.  The  lead  monomials  of [22Xu[122X and [22Xv[122X are marked by bullets. In the left
  hand  diagram  the  two  shaded  areas  indicate  those  monomials which are
  conventionally  reducible  by  [22Xu[122X  and  by  [22Xv[122X, so that the doubly shaded area
  contains  those monomials which are conventionally reducible by both. For an
  involutive division, this must be avoided.[133X
  
  [33X[0;0YIn the right-hand diagram we see that [22Xu[122X involutively divides the same set of
  monomials  in  the  main  shaded area. On the other hand [22Xv[122X just involutively
  divides  monomials [22X{a^j âˆ£ j â‰¥ 3}[122X. So none of the monomials [22X{a^jb, a^jb^2 âˆ£ j
  â‰¥  3}[122X  reduce  by  [22Xv[122X  involutively.  The  operation  [10XInvolutiveBasis[110X,  to be
  described  below,  produces  two further polynomials, [22Xw = vb = a^3b-3b^2[122X and
  [22Xvb^2[122X which reduces by [22Xu[122X to [22Xx = a^3b^2 - 9a[122X. Both [22Xw[122X and [22Xx[122X have multiplicative
  variables  [22X{a}[122X  and  the  monomials  which  they  can  reduce lie on the two
  horizantal  line  segments  in  the right-hand diagram. In this way, all the
  conventionally reducible monomials are involutively reducible by just one of
  [22X{u,v,w,x}[122X.[133X
  
  [33X[0;0YThe polynomial [22Xp = a^3b^3 + 2a^3b + 3ab^3[122X reduces involutively as follows.[133X
  
  
  [24X[33X[0;6Yp     \stackrel{u}{\longrightarrow}     3a^4     +     2a^3b     +     3ab^3
  \stackrel{v}{\longrightarrow}       2a^3b       +      3ab^3      +      9ab
  \stackrel{w}{\longrightarrow}       3ab^3       +       9ab      +      6b^2
  \stackrel{u}{\longrightarrow} 9a^2 + 9ab + 6b^2[133X
  
  [124X
  
  [33X[0;0YThis reduction is computed in section [14X3.3-2[114X.[133X
  
  [1X3.2-7 IPolyReduce[101X
  
  [33X[1;0Y[29X[2XIPolyReduce[102X( [3Xalgebra[103X, [3Xpolynomial[103X, [3XDivisionRecord[103X, [3Xorder[103X ) [32X function[133X
  [33X[1;0Y[29X[2XIPolyReduceCP[102X( [3Xalgebra[103X, [3Xpolynomial[103X, [3XDivisionRecord[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YThe  global  function  [10XIPolyReduce[110X calls one of the operations [10XIPolyReduceCP[110X
  and  [10XIPolyReduceNP[110X  depending  on whether the algebra is commutative or not.
  This  function reduces a polynomial [22Xp[122X using the current overlap record for a
  basis, and an ordering.[133X
  
  [33X[0;0YIn  the  example the polynomial [22Xp[122X reduces only to [22X9a^2+9ab+2a^3b[122X because the
  polynomial [22Xx[122X is not available to reduce [22X2a^3b[122X to [22X6b^2[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27Xp := a^3*b^3 + 2*a^3*b + 3*a*b^3;;[127X[104X
    [4X[25Xgap>[125X [27Xq := IPolyReduce( R, p, drec2, ord );[127X[104X
    [4X[28X2*a^3*b+9*a^2+9*a*b[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [1X3.2-8 IAutoreduce[101X
  
  [33X[1;0Y[29X[2XIAutoreduce[102X( [3Xalg[103X, [3Xpolys[103X, [3Xorder[103X ) [32X function[133X
  [33X[1;0Y[29X[2XIAutoreduceCP[102X( [3Xalg[103X, [3Xpolys[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YThe  global  function  [10XIAutoreduce[110X calls one of the operations [10XIAutoreduceCP[110X
  and  [10XIAutoreduceNP[110X  depending  on whether the algebra is commutative or not.
  This function applies [10XIPolyReduce[110X to a list of polynomials recursively until
  no   more   reductions   are  possible.  More  specifically,  this  function
  involutively  reduces  each  member of a list of polynomials with respect to
  all  the other members of the list, removing the polynomial from the list if
  it  is  involutively  reduced  to  0. This process is iterated until no more
  reductions are possible.[133X
  
  [33X[0;0YIn  the  example  we form [10XL[110X by adding [22Xp[122X to [10XL2[110X. Applying [10XIAutoreduceCP[110X only [22Xp[122X
  reduces, and the concatenation of [10XL2[110X with [22Xq[122X is returned.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XL := Concatenation( L2, [p] );;[127X[104X
    [4X[25Xgap>[125X [27XIAutoreduceCP( R, L, ord );[127X[104X
    [4X[28X[ b^3-3*a, a^3-3*b, 2*a^3*b+9*a^2+9*a*b ][128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  
  [1X3.3 [33X[0;0YComputing a Commutative Involutive Basis[133X[101X
  
  [33X[0;0YThe   involutive   algorithm  for  constructing  an  involutive  basis  uses
  [13Xprolongations[113X and [13Xautoreduction[113X.[133X
  
  
  [1X3.3-1 [33X[0;0YProlongations and Autoreduction[133X[101X
  
  [33X[0;0YGiven  a  set  of  polynomials  [22XP[122X, a [13Xprolongation[113X of [22Xp âˆˆ P[122X is a product [22Xpa_i[122X
  where  the  generator  [22Xa_i[122X is [13Xnot[113X multiplicative with respect to the current
  involutive division.[133X
  
  [33X[0;0YA  set  of  polynomials  [22XP[122X  is said to be [13Xautoreduced[113X if no polynomial [22Xp âˆˆ P[122X
  contains  a term which is involutively divisible by some polynomial [22Xp' âˆˆ P âˆ–
  {p}[122X.[133X
  
  [33X[0;0YWe  denote  by  [22Xrem_I(p,Q)[122X  the  involutive  remainder  of polynomial [22Xp[122X with
  respect  to  a  set  of polynomials [22XQ[122X. Here is the [13XCommutative Autoreduction
  Algorithm[113X:[133X
  
  [4X[32X[104X
    [4XInput: a set of polynomials P = {p_1,p_2,...,p_n} and an involutive division I [104X
    [4X  while there exists p_i in P such that rem_I(p_i, P\{p_i}) <> p_i do[104X
    [4X    q := Rem_I(p_i, P\{p_i});[104X
    [4X    P := P\{p_i};[104X
    [4X    if (q<>0) then[104X
    [4X      P := P union {q};[104X
    [4X    fi;[104X
    [4X  od;[104X
    [4X  return P;[104X
  [4X[32X[104X
  
  [33X[0;0YIt  can  be  shown  that if [22XP[122X is a set of polynomials over a polynomial ring
  [22XmathcalR  =  R[a_1,...,a_n][122X,  such  that [22XP[122X is autoreduced with respect to an
  involutive  division  [22XI[122X,  and  if  [22Xp,q[122X are two polynomials in [22XmathcalR[122X, then
  [22Xrem_I(p,P) + rem_I(q,P) = rem_I(p+q,P)[122X.[133X
  
  [33X[0;0YGiven  an  involutive  division  [22XI[122X and an admissible monomial ordering [22XO[122X, an
  autoreduced  set of polynomials [22XP[122X is a [13Xlocally involutive basis[113X with respect
  to  [22XI[122X  and [22XO[122X if any prolongation of any [22Xp_i âˆˆ P[122X involutively reduces to zero
  using  [22XP[122X.  Further,  [22XP[122X is an [13Xinvolutive basis[113X with respect to [22XI[122X and [22XO[122X if any
  multiple  [22Xp_it[122X  of  any  [22Xp_i  âˆˆ P[122X by any term [22Xt[122X involutively reduces to zero
  using [22XP[122X.[133X
  
  [33X[0;0YThe [13XCommutative Involutive Basis Algorithm[113X:[133X
  
  [4X[32X[104X
    [4XInput: a basis F = {f_1,f_2,...,f_m} for an ideal J [104X
    [4X       over a commutative polynomial ring R[a_1,...,a_n];[104X
    [4X       an admissible monomial ordering O; [104X
    [4X       a continuous and constructive involutive division I [104X
    [4XOutput: an involutive basis G = {g_1,g_2,...,g_k} for J (if it terminates)[104X
    [4X  G := { };[104X
    [4X  F := autoreduction of F with respect to O and I;[104X
    [4X  while G = { } do[104X
    [4X    P := set of all prolongations f_i*a_j, 1<=i<=m, 1<=j<=n;[104X
    [4X    q := 0;[104X
    [4X    while (P <> { }) and (q=0) do[104X
    [4X      p := a polynomial in P with minimal lead monomial w.r.t. O;[104X
    [4X      P := P \ {p};[104X
    [4X      q := rem_I(p,F);[104X
    [4X    od;[104X
    [4X    if (q <> 0) then  ## new basis element found[104X
    [4X      F := autoreduction of (F union {q})[104X
    [4X    else  ## all the prolongations have reduced to zero[104X
    [4X      G := F;[104X
    [4X    fi;[104X
    [4X  od;[104X
    [4X  return G;[104X
  [4X[32X[104X
  
  [1X3.3-2 InvolutiveBasis[101X
  
  [33X[1;0Y[29X[2XInvolutiveBasis[102X( [3Xalg[103X, [3Xpolys[103X, [3Xorder[103X ) [32X function[133X
  [33X[1;0Y[29X[2XInvolutiveBasisCP[102X( [3Xalg[103X, [3Xpolys[103X, [3Xorder[103X ) [32X operation[133X
  
  [33X[0;0YThe   global   function   [10XInvolutiveBasis[110X   calls   one  of  the  operations
  [10XInvolutiveBasisCP[110X  and [10XInvolutiveBasisNP[110X depending on whether the algebra is
  commutative  or  not.  This function finds an involutive basis for the ideal
  generated  by  a  set of polynomials, using a chosen ordering, and returns a
  division record.[133X
  
  [33X[0;0YAny  involutive  basis  returned  by  this algorithm is a GrÃ¶bner basis, and
  remainders are involutively unique with respect to this basis.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XibasP := InvolutiveBasis( R, L2, ord );[127X[104X
    [4X[28Xrec( div := "Pommaret", mvars := [ [ 1, 2 ], [ 1 ], [ 1 ], [ 1 ] ], [128X[104X
    [4X[28X  polys := [ b^3-3*a, a^3-3*b, a^3*b-3*b^2, a^3*b^2-9*a ] )[128X[104X
    [4X[25Xgap>[125X [27Xr := IPolyReduce( R, p, ibasP, ord );[127X[104X
    [4X[28X9*a^2+9*a*b+6*b^2[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YIn  the example above we start with [22XF={u,v}[122X. There is only one prolongation,
  [22XP={w=vb}[122X  and  [22XF[122X  becomes  [22X{u,v,w}[122X.  At  the second iteration, [22XP={vb,wb}[122X; [22Xvb[122X
  reduces  to zero; [22Xwb[122X reduces to [22Xx=a^3b^2-9a[122X; and [22XF[122X becomes [22X{u,v,w,x}[122X. At the
  third iteration [22XP={vb,wb,xb}[122X and all three of these reduce to zero, so [22XG = F[122X
  is returned.[133X
  
  [33X[0;0YIt  is  then  shown  that  the  multiplicative  variables  for [22X{u,v,w,x}[122X are
  [22X{{a,b},{a},{a},{a}}[122X.[133X
  
  [33X[0;0YFinally,  the  full  reduction  [22Xr[122X  of  [22Xp[122X, as described at the end of section
  [14X3.2-6[114X, is computed.[133X
  
  [33X[0;0YIf, instead of the Pommaret division, we use Thomas or Janet we obtain:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[28X[128X[104X
    [4X[25Xgap>[125X [27XCommutativeDivision := "Thomas";;[127X[104X
    [4X[25Xgap>[125X [27XibasT := InvolutiveBasis( R, L2, ord );[127X[104X
    [4X[28Xrec( div := "Thomas", [128X[104X
    [4X[28X  mvars := [ [ 2 ], [ 1 ], [ 2 ], [ 1 ], [ 2 ], [ 1 ], [ 1, 2 ] ], [128X[104X
    [4X[28X  polys := [ b^3-3*a, a^3-3*b, a*b^3-3*a^2, a^3*b-3*b^2, a^2*b^3-9*b, [128X[104X
    [4X[28X      a^3*b^2-9*a, a^3*b^3-9*a*b ] )[128X[104X
    [4X[25Xgap>[125X [27XCommutativeDivision := "Janet";;[127X[104X
    [4X[25Xgap>[125X [27XibasJ := InvolutiveBasis( R, L2, ord );;[127X[104X
    [4X[25Xgap>[125X [27XibasJ.mvars = ibasP.mvars;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XibasJ.polys = ibasP.polys;[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[28X[128X[104X
  [4X[32X[104X
  
  [33X[0;0YThe  Janet  division  gives  the  same involutive basis as Pommaret, but the
  Thomas Division produces [22X7[122X, rather than [22X4[122X polynomials:[133X
  
  
  [24X[33X[0;6Y[~   b^3-3a,\   a^3-3b,\  ab^3-3a^2,\  a^3b-3b^2,\  a^2b^3-9b,\  a^3b^2-9a,\
  a^3b^3-9ab ~].[133X
  
  [124X
  
  [33X[0;0YThe multiplicative variables for these polynomials are [22X[ {b}, {a}, {b}, {a},
  {b}, {a}, {a,b} ][122X, so the reduction diagram for the Thomas basis is:[133X
  
  
  [24X[33X[0;6Y\vcenter{\xymatrix@=1em{  b  &  &  & & & & & & \\ : \ar[u] & \cdot & \cdot &
  \cdot  \ar@{-}[ur]  &  \cdot  &  \cdot & \cdot & & \\ 5 \ar@{-}[u] & \cdot &
  \cdot  &  \cdot  \ar@{-}[uurr] & \cdot & \cdot & \cdot & & \\ 4 \ar@{-}[u] &
  \cdot & \cdot & \cdot \ar@{-}[uuurrr] & \cdot & \cdot & \cdot & & \\ \bullet
  \ar@{-}[u]  \ar@{-}[rrrrrrr] & \bullet \ar@{-}[uuuu] & \bullet \ar@{-}[uuuu]
  &  \bullet \ar@{-}[uuuurrrr] & \cdot \ar@{-}[uuurrr] & \cdot \ar@{-}[uurr] &
  \cdot   \ar@{-}[ur]  &  &  \\  2  \ar@{-}[u]  &  \cdot  &  \cdot  &  \bullet
  \ar@{-}[rrrr]  & \cdot & \cdot & \cdot & & \\ 1 \ar@{-}[u] & \cdot & \cdot &
  \bullet  \ar@{-}[rrrr] & \cdot & \cdot & \cdot & & \\ 0 \ar@{-}[r]\ar@{-}[u]
  &  1  \ar@{-}[r]  &  2  \ar@{-}[r] & \bullet \ar@{-}[r] \ar@{-}[uuuuuuu] & 4
  \ar@{-}[r] & 5 \ar@{-}[r] & \cdots \ar[r] & a & }}[133X
  
  [124X
  
